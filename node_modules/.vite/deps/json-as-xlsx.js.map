{
  "version": 3,
  "sources": ["../../json-as-xlsx/dist/index.js"],
  "sourcesContent": ["\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.libraryName=exports.xlsx=exports.getWorksheetColumnWidths=exports.getJsonSheetRow=exports.getContentProperty=exports.utils=void 0;const xlsx_1=require(\"xlsx\");Object.defineProperty(exports,\"utils\",{enumerable:true,get:function(){return xlsx_1.utils}});const getContentProperty=(content,property)=>{const accessContentProperties=(content,properties)=>{const value=content[properties[0]];if(properties.length===1){return value!==null&&value!==void 0?value:\"\"}if(value===undefined||typeof value===\"string\"||typeof value===\"boolean\"||typeof value===\"number\"||value instanceof Date){return\"\"}return accessContentProperties(value,properties.slice(1))};const properties=property.split(\".\");return accessContentProperties(content,properties)};exports.getContentProperty=getContentProperty;const getJsonSheetRow=(content,columns)=>{const jsonSheetRow={};columns.forEach(column=>{if(typeof column.value===\"function\"){jsonSheetRow[column.label]=column.value(content)}else{jsonSheetRow[column.label]=(0,exports.getContentProperty)(content,column.value)}});return jsonSheetRow};exports.getJsonSheetRow=getJsonSheetRow;const applyColumnFormat=(worksheet,columnIds,columnFormats)=>{var _a;for(let i=0;i<columnIds.length;i+=1){const columnFormat=columnFormats[i];if(!columnFormat){continue}const column=xlsx_1.utils.decode_col(columnIds[i]);const range=xlsx_1.utils.decode_range((_a=worksheet[\"!ref\"])!==null&&_a!==void 0?_a:\"\");for(let row=range.s.r+1;row<=range.e.r;++row){const ref=xlsx_1.utils.encode_cell({r:row,c:column});if(worksheet[ref]){worksheet[ref].z=columnFormat}}}};const getWorksheetColumnIds=worksheet=>{var _a;const columnRange=xlsx_1.utils.decode_range((_a=worksheet[\"!ref\"])!==null&&_a!==void 0?_a:\"\");const columnIds=[];for(let C=columnRange.s.c;C<=columnRange.e.c;C++){const address=xlsx_1.utils.encode_col(C);columnIds.push(address)}return columnIds};const getObjectLength=object=>{if(typeof object===\"string\"){return object.length}if(typeof object===\"number\"){return object.toString().length}if(typeof object===\"boolean\"){return object?\"true\".length:\"false\".length}if(object instanceof Date){return object.toString().length}return 0};const getWorksheetColumnWidths=(worksheet,extraLength=1)=>{const columnLetters=getWorksheetColumnIds(worksheet);return columnLetters.map(column=>{const columnCells=Object.keys(worksheet).filter(cell=>{return cell.replace(/[0-9]/g,\"\")===column});const maxWidthCell=columnCells.reduce((maxWidth,cellId)=>{const cell=worksheet[cellId];const cellContentLength=getObjectLength(cell.v);if(!cell.z){return Math.max(maxWidth,cellContentLength)}const cellFormatLength=cell.z.length;const largestWidth=Math.max(cellContentLength,cellFormatLength);return Math.max(maxWidth,largestWidth)},0);return{width:maxWidthCell+extraLength}})};exports.getWorksheetColumnWidths=getWorksheetColumnWidths;const getWorksheet=(jsonSheet,settings)=>{let jsonSheetRows;if(jsonSheet.content.length>0){jsonSheetRows=jsonSheet.content.map(contentItem=>{return(0,exports.getJsonSheetRow)(contentItem,jsonSheet.columns)})}else{jsonSheetRows=jsonSheet.columns.map(column=>({[column.label]:\"\"}))}const worksheet=xlsx_1.utils.json_to_sheet(jsonSheetRows);const worksheetColumnIds=getWorksheetColumnIds(worksheet);const worksheetColumnFormats=jsonSheet.columns.map(jsonSheetColumn=>{var _a;return(_a=jsonSheetColumn.format)!==null&&_a!==void 0?_a:null});applyColumnFormat(worksheet,worksheetColumnIds,worksheetColumnFormats);worksheet[\"!cols\"]=(0,exports.getWorksheetColumnWidths)(worksheet,settings.extraLength);return worksheet};const writeWorkbook=(workbook,settings={})=>{var _a,_b,_c,_d;var _e;const RTL=Boolean(settings.RTL);(_a=workbook.Workbook)!==null&&_a!==void 0?_a:workbook.Workbook={};(_b=(_e=workbook.Workbook).Views)!==null&&_b!==void 0?_b:_e.Views=[{}];workbook.Workbook.Views.forEach(view=>{view.RTL=RTL});const filename=`${(_c=settings.fileName)!==null&&_c!==void 0?_c:\"Spreadsheet\"}.xlsx`;const writeOptions=(_d=settings.writeOptions)!==null&&_d!==void 0?_d:{};if(settings.writeMode===\"write\"){return(0,xlsx_1.write)(workbook,writeOptions)}else if(settings.writeMode===\"writeFile\"){return(0,xlsx_1.writeFile)(workbook,filename,writeOptions)}else{return writeOptions.type===\"buffer\"?(0,xlsx_1.write)(workbook,writeOptions):(0,xlsx_1.writeFile)(workbook,filename,writeOptions)}};const xlsx=(jsonSheets,settings={},workbookCallback=()=>{})=>{if(jsonSheets.length===0)return;const workbook=xlsx_1.utils.book_new();jsonSheets.forEach((actualSheet,actualIndex)=>{var _a;const worksheet=getWorksheet(actualSheet,settings);const worksheetName=(_a=actualSheet.sheet)!==null&&_a!==void 0?_a:`Sheet ${actualIndex+1}`;xlsx_1.utils.book_append_sheet(workbook,worksheet,worksheetName)});workbookCallback(workbook);return writeWorkbook(workbook,settings)};exports.xlsx=xlsx;exports.default=exports.xlsx;exports.libraryName=\"json-as-xlsx\";module.exports=exports.xlsx;module.exports.getContentProperty=exports.getContentProperty;module.exports.getJsonSheetRow=exports.getJsonSheetRow;module.exports.getWorksheetColumnWidths=exports.getWorksheetColumnWidths;module.exports.utils=xlsx_1.utils;"],
  "mappings": "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",
  "names": ["content", "properties"]
}
